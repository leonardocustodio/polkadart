---
import CodeBlock from './CodeBlock.astro';

let stateExample = '';
let keyringExample = '';

try {
	stateExample = await import(`../../snippets/storage.dart?raw`).then(module => module.default);
	keyringExample = await import(`../../snippets/keypair.dart?raw`).then(module => module.default);
} catch (error) {
	stateExample = `// Error: Could not load snippet`;
	keyringExample = `// Error: Could not load snippet`;
}
---

<section class="state-management">
	<div class="container">
		<div class="state-section">
			<div class="state-content">
				<h2>Safety with generated types</h2>
				<p>Generate Dart types directly from on-chain metadata to ensure your application stays in sync with any runtime version. Catch type errors at compile-time rather than runtime, with full IDE autocomplete support for available methods and properties.
				</p>
			</div>
			<div class="state-code">
				<div class="code-window">
					<div class="code-header">
						<div class="code-dots">
							<span></span>
							<span></span>
							<span></span>
						</div>
						<span class="code-title">counter.dart</span>
					</div>
					<div class="code-content">
						<CodeBlock code={stateExample} lang="dart" />
					</div>
				</div>
			</div>
		</div>

		<div class="state-section reverse">
			<div class="state-content">
				<h2>Works with any Polkadot-SDK blockchain</h2>
				<p>Connect to Polkadot, Kusama, or any parachain in the ecosystem using the same consistent API.</p>
				<p>The library automatically adapts to chain-specific features while maintaining a unified interface, letting you focus on building great applications instead of handling protocol differences.</p>
		</div>
			<div class="state-code">
				<div class="code-window">
					<div class="code-header">
						<div class="code-dots">
							<span></span>
							<span></span>
							<span></span>
						</div>
						<span class="code-title">todos.dart</span>
					</div>
					<div class="code-content">
						<CodeBlock code={keyringExample} lang="dart" />
					</div>
				</div>
			</div>
		</div>
	</div>
</section>

<style>
	.state-management {
		padding: 6rem 0;
		background-color: var(--color-background);
	}

	.state-section {
		display: grid;
		grid-template-columns: 1fr 1fr;
		gap: 4rem;
		align-items: center;
		margin-bottom: 8rem;
	}

	.state-section.reverse {
		grid-template-columns: 1fr 1fr;
	}

	.state-section.reverse .state-content {
		order: 2;
	}

	.state-section.reverse .state-code {
		order: 1;
	}

	.state-content h2 {
		font-size: 2.5rem;
		font-weight: 700;
		margin-bottom: 1.5rem;
		color: var(--color-text-primary);
		line-height: 1.2;
	}

	.state-content p {
		font-size: 1.125rem;
		color: var(--color-text-secondary);
		margin-bottom: 1rem;
		line-height: 1.6;
	}

	.state-content code {
		background-color: var(--color-surface);
		padding: 0.2em 0.4em;
		border-radius: 0.25rem;
		font-size: 0.875em;
		font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
		border: 1px solid var(--color-border);
	}

	.state-content em {
		font-style: normal;
		color: var(--color-primary);
		font-weight: 500;
	}

	.code-window {
		background: var(--color-surface);
		border-radius: 0.5rem;
		overflow: hidden;
		border: 1px solid var(--color-border);
		box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
	}

	.code-header {
		display: flex;
		align-items: center;
		padding: 1rem;
		background: var(--color-surface);
		border-bottom: 1px solid var(--color-border);
	}

	.code-dots {
		display: flex;
		gap: 0.5rem;
		margin-right: 1rem;
	}

	.code-dots span {
		width: 12px;
		height: 12px;
		border-radius: 50%;
	}

	.code-dots span:nth-child(1) { background: #ff5f56; }
	.code-dots span:nth-child(2) { background: #ffbd2e; }
	.code-dots span:nth-child(3) { background: #27c93f; }

	.code-title {
		color: var(--color-text-secondary);
		font-size: 0.875rem;
	}

	.code-content {
		padding: 1rem;
	}

	.code-content :global(.code-block) {
		margin: 0;
		border: none;
	}

	@media (max-width: 1024px) {
		.state-section,
		.state-section.reverse {
			grid-template-columns: 1fr;
			gap: 2rem;
			margin-bottom: 4rem;
		}

		.state-section.reverse .state-content,
		.state-section.reverse .state-code {
			order: 0;
		}

		.state-content h2 {
			font-size: 2rem;
		}
	}

	@media (max-width: 768px) {
		.state-management {
			padding: 3rem 0;
		}

		.state-content h2 {
			font-size: 1.75rem;
		}

		.state-content p {
			font-size: 1rem;
		}
	}
</style>